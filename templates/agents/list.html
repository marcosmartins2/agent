{% extends 'base.html' %}
{% load static %}

{% block title %}Agente IA - PanDia{% endblock %}
{% block page_title %}Agente IA{% endblock %}

{% block content %}
<div class="content-header">
    <div>
        <h2 class="content-title">Agente IA</h2>
        <p class="content-subtitle">Configure seu agente conversacional</p>
    </div>
    <a href="{% url 'agents:create' %}" class="btn btn-primary">
        + Criar Agente
    </a>
</div>

<!-- Filter by Organization -->
<div class="card" style="margin-bottom: 1.5rem;">
    <form method="get" id="filterForm">
        <div class="form-group" style="margin-bottom: 0;">
            <label class="form-label" for="organization">Filtrar por Organização</label>
            <select name="organization" id="organization" class="form-select" onchange="document.getElementById('filterForm').submit();">
                <option value="">Todas as Organizações</option>
                {% for org in user.organizations.all %}
                    <option value="{{ org.slug }}" {% if request.GET.organization == org.slug %}selected{% endif %}>
                        {{ org.name }}
                    </option>
                {% endfor %}
            </select>
        </div>
    </form>
</div>

{% if agents %}
    {% for agent in agents %}
    <div class="list-item">
        <div class="list-item-content">
            <h3 class="list-item-title">
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                </svg>
                {{ agent.name }}
                <span class="badge badge-success">{{ agent.status }}</span>
            </h3>
            <div class="list-item-meta">
                <span>Função: {{ agent.role }}</span>
                <span>Personalidade: {{ agent.personality }}</span>
                <span>Criado em {{ agent.created_at|date:"d/m/Y" }}</span>
            </div>
        </div>
        <div class="list-item-actions">
            <a href="{% url 'agents:playground' agent.slug %}" class="btn-icon btn-icon-blue" title="Testar">
                <svg width="18" height="18" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M8 5v14l11-7z"/>
                </svg>
            </a>
            <a href="{% url 'agents:edit' agent.slug %}" class="btn-icon btn-icon-gray" title="Editar">
                <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                </svg>
            </a>
            <a href="{% url 'agents:delete' agent.slug %}" class="btn-icon btn-icon-red" title="Excluir">
                <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <polyline points="3 6 5 6 21 6"></polyline>
                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                </svg>
            </a>
        </div>
    </div>
    {% endfor %}
{% else %}
    <div class="empty-state">
        <svg class="empty-state-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path d="M13 10V3L4 14h7v7l9-11h-7z"></path>
        </svg>
        <h3 class="empty-state-title">Nenhum agente ainda</h3>
        <p class="empty-state-text">Crie seu primeiro agente para começar</p>
        <a href="{% url 'agents:create' %}" class="btn btn-primary">
            + Criar Agente
        </a>
    </div>
{% endif %}
{% endblock %}
